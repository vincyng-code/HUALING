<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸€å¿µé€é™ - åŒ–éˆè‡ºå‡ç´šè¨ˆç®—å™¨</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Microsoft JhengHei', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif;
            margin: 0;
            padding: 0;
        }
        
        body {
            background-color: #f5f0e6;
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #d4b483;
            background-color: #fff;
            border-radius: 15px 15px 0 0;
            padding: 30px 20px 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        h1 {
            color: #8b4513;
            margin-top: 0;
            font-size: 2rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .subtitle {
            color: #a0522d;
            font-size: 1rem;
            margin-top: 5px;
        }
        
        .breakthrough-info {
            background-color: #f9f5eb;
            padding: 20px;
            border-radius: 10px;
            margin: 25px auto;
            max-width: 900px;
            border: 1px solid #e0d6c2;
        }
        
        .breakthrough-title {
            color: #8b4513;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .breakthrough-title:before {
            content: "â°";
            margin-right: 10px;
        }
        
        .breakthrough-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 600px) {
            .breakthrough-inputs {
                grid-template-columns: 1fr;
            }
        }
        
        .estimated-date-display {
            background-color: #e8f4fd;
            color: #1971c2;
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
            border-left: 4px solid #4dabf7;
            font-size: 1.1rem;
        }
        
        .countdown-display {
            background-color: #8b4513;
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 1.4rem;
            margin-top: 15px;
            box-shadow: 0 5px 15px rgba(139, 69, 19, 0.2);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 20px;
        }
        
        @media (max-width: 1100px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .input-section, .results-section {
            background-color: #fff;
            padding: 25px;
            border-radius: 10px;
            border: 1px solid #e0d6c2;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .section-title {
            color: #8b4513;
            border-bottom: 1px solid #d4b483;
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
        }
        
        .section-title:before {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .input-section .section-title:before {
            content: "ğŸ“Š";
        }
        
        .results-section .section-title:before {
            content: "ğŸ“ˆ";
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #5d4037;
        }
        
        select, input[type="number"], input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #c9b8a4;
            border-radius: 8px;
            font-size: 1rem;
            background-color: #fff;
            transition: border-color 0.3s;
        }
        
        select:focus, input[type="number"]:focus, input[type="text"]:focus {
            outline: none;
            border-color: #8b4513;
            box-shadow: 0 0 0 2px rgba(139, 69, 19, 0.1);
        }
        
        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 600px) {
            .input-row {
                grid-template-columns: 1fr;
            }
        }
        
        .time-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 500px) {
            .time-inputs {
                grid-template-columns: 1fr;
            }
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        @media (max-width: 500px) {
            .button-group {
                flex-direction: column;
            }
        }
        
        button {
            padding: 14px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }
        
        #calculateBtn {
            background-color: #8b4513;
            color: white;
        }
        
        #calculateBtn:hover {
            background-color: #a0522d;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 69, 19, 0.2);
        }
        
        #resetBtn {
            background-color: #b0a18e;
            color: white;
        }
        
        #resetBtn:hover {
            background-color: #9c8e7d;
        }
        
        .result-item {
            background-color: #f9f5eb;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 5px solid #8b4513;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .result-title {
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .result-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #5d4037;
            margin: 10px 0;
            word-break: break-word;
        }
        
        @media (max-width: 500px) {
            .result-value {
                font-size: 1.3rem;
            }
        }
        
        .highlight {
            color: #d35400;
            font-size: 1.8rem;
        }
        
        @media (max-width: 500px) {
            .highlight {
                font-size: 1.5rem;
            }
        }
        
        .warning {
            color: #c0392b;
            font-weight: bold;
        }
        
        .success {
            color: #27ae60;
            font-weight: bold;
        }
        
        .info-text {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
        
        .breakdown-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .breakdown-table th, .breakdown-table td {
            padding: 10px 12px;
            text-align: center;
            border: 1px solid #e0d6c2;
            font-size: 0.9rem;
        }
        
        @media (max-width: 500px) {
            .breakdown-table th, .breakdown-table td {
                padding: 8px 6px;
                font-size: 0.85rem;
            }
        }
        
        .breakdown-table th {
            background-color: #f1e8d9;
            color: #5d4037;
            font-weight: bold;
        }
        
        .breakdown-table tr:nth-child(even) {
            background-color: #f9f5eb;
        }
        
        .advance-options {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px dashed #d4b483;
        }
        
        .advance-title {
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .checkbox-container {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .checkbox-container input {
            width: auto;
            margin-right: 10px;
            min-width: 18px;
            min-height: 18px;
        }
        
        .note-box {
            background-color: #e8f4fd;
            border-left: 5px solid #3498db;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
            font-size: 0.9rem;
        }
        
        .note-title {
            font-weight: bold;
            color: #2980b9;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e0d6c2;
            color: #777;
            font-size: 0.9rem;
            padding-bottom: 20px;
        }
        
        .monster-select-info {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.9rem;
            color: #666;
        }
        
        .monster-power {
            color: #8b4513;
            font-weight: bold;
        }
        
        .data-source {
            font-size: 0.8rem;
            color: #888;
            text-align: right;
            margin-top: 5px;
        }
        
        .countdown-timer {
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .time-unit {
            display: inline-block;
            min-width: 70px;
            text-align: center;
            margin: 0 5px;
        }
        
        @media (max-width: 500px) {
            .time-unit {
                min-width: 60px;
                margin: 0 3px;
            }
        }
        
        .time-value {
            font-size: 1.8rem;
            color: #ffd700;
            font-weight: bold;
        }
        
        @media (max-width: 500px) {
            .time-value {
                font-size: 1.5rem;
            }
        }
        
        .time-label {
            font-size: 0.8rem;
            color: #ffcc80;
            display: block;
            margin-top: 5px;
        }
        
        .beijing-time {
            font-size: 0.9rem;
            color: #fff;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
        }
        
        .current-time {
            color: #ffcc80;
            font-weight: bold;
        }
        
        .attribute-levels-container {
            background-color: #f9f5eb;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0d6c2;
            margin-bottom: 20px;
        }
        
        .attribute-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .attribute-table th, .attribute-table td {
            padding: 12px 8px;
            text-align: center;
            border: 1px solid #e0d6c2;
        }
        
        .attribute-table th {
            background-color: #f1e8d9;
            color: #5d4037;
            font-weight: bold;
        }
        
        .attribute-table td {
            background-color: #fff;
        }
        
        .priority-cell {
            width: 80px;
        }
        
        .priority-select {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #c9b8a4;
            background-color: #fff;
        }
        
        .level-select {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #c9b8a4;
            background-color: #fff;
        }
        
        .sunday-bonus-container {
            background-color: #f1f8e9;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid #7cb342;
        }
        
        .sunday-bonus-title {
            font-weight: bold;
            color: #558b2f;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .sunday-bonus-title:before {
            content: "ğŸ’°";
            margin-right: 8px;
        }
        
        .souls-breakdown {
            margin-top: 10px;
            padding: 15px;
            background-color: #f0f7ff;
            border-radius: 8px;
            border-left: 4px solid #4dabf7;
        }
        
        .souls-breakdown-title {
            font-weight: bold;
            color: #1971c2;
            margin-bottom: 10px;
        }
        
        .souls-breakdown-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px dashed #d0e7ff;
        }
        
        .souls-breakdown-label {
            color: #5d4037;
        }
        
        .souls-breakdown-value {
            font-weight: bold;
            color: #1971c2;
        }
        
        .sunday-bonus-item {
            background-color: #e8f5e9;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #66bb6a;
        }
        
        .sunday-bonus-label {
            font-weight: bold;
            color: #388e3c;
            margin-bottom: 5px;
        }
        
        .sunday-bonus-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #2e7d32;
        }
        
        .priority-info {
            font-size: 0.8rem;
            color: #888;
            margin-top: 5px;
            text-align: center;
        }
        
        .sunday-bonus-checkbox {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .sunday-bonus-checkbox input {
            width: auto;
            margin-right: 10px;
        }
        
        .sunday-bonus-checkbox label {
            font-weight: bold;
            color: #5d4037;
            margin-bottom: 0;
        }
        
        /* å­˜æª”åŠŸèƒ½æ¨£å¼ */
        .save-section {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e0d6c2;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-top: 25px;
        }
        
        .save-section .section-title:before {
            content: "ğŸ’¾";
        }
        
        .save-slots {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 800px) {
            .save-slots {
                grid-template-columns: 1fr;
            }
        }
        
        .save-slot {
            background-color: #f9f5eb;
            border: 2px solid #e0d6c2;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s;
        }
        
        .save-slot.active {
            border-color: #8b4513;
            background-color: #f1e8d9;
        }
        
        .save-slot-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .save-slot-name {
            font-weight: bold;
            color: #5d4037;
            flex: 1;
        }
        
        .save-slot-name-input {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #c9b8a4;
            font-size: 0.9rem;
        }
        
        .save-slot-content {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 15px;
            min-height: 60px;
        }
        
        .save-slot-actions {
            display: flex;
            gap: 8px;
        }
        
        .save-slot-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }
        
        .save-slot-btn.load {
            background-color: #5d4037;
            color: white;
        }
        
        .save-slot-btn.load:hover {
            background-color: #8b4513;
        }
        
        .save-slot-btn.save {
            background-color: #27ae60;
            color: white;
        }
        
        .save-slot-btn.save:hover {
            background-color: #219653;
        }
        
        .save-slot-btn.delete {
            background-color: #e74c3c;
            color: white;
        }
        
        .save-slot-btn.delete:hover {
            background-color: #c0392b;
        }
        
        .save-slot-btn.rename {
            background-color: #3498db;
            color: white;
        }
        
        .save-slot-btn.rename:hover {
            background-color: #2980b9;
        }
        
        .save-info {
            font-size: 0.8rem;
            color: #888;
            text-align: center;
            margin-top: 10px;
        }
        
        /* ç§»é™¤åŸå…ˆçš„è€ƒæ…®è¬å¦–é–‹æ”¾æ™‚é–“é¸é … */
        .advance-options .checkbox-container:first-child {
            display: none;
        }
        
        .breakthrough-date-display {
            font-size: 0.9rem;
            color: #fff;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
        }
        
        .breakthrough-date-value {
            color: #ffcc80;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ä¸€å¿µé€é™ - åŒ–éˆè‡ºå‡ç´šè¨ˆç®—å™¨</h1>
            <div class="subtitle">æ ¹æ“šå®˜æ–¹æ•¸æ“šè¨ˆç®—åŒ–éˆè‡ºå‡ç´šæ‰€éœ€å¦–é­„èˆ‡è¬å¦–æŒ‘æˆ°æ¬¡æ•¸</div>
        </header>
        
        <div class="breakthrough-info">
            <div class="breakthrough-title">çªç ´æ™‚é–“è¨­å®š (åŒ—äº¬æ™‚é–“)</div>
            
            <div id="estimatedDateContainer" style="display: none;">
                <div class="estimated-date-display">
                    é è¨ˆçªç ´æ—¥æœŸï¼š<span id="estimatedBreakthroughDate">å°šæœªè¨­å®š</span>
                </div>
            </div>
            
            <div class="breakthrough-inputs">
                <div class="form-group">
                    <label for="daysToBreakthrough">å¤©æ•¸ï¼š</label>
                    <input type="number" id="daysToBreakthrough" min="0" value="0" placeholder="å¤©æ•¸">
                </div>
                <div class="form-group">
                    <label for="hoursToBreakthrough">å°æ™‚ï¼š</label>
                    <input type="number" id="hoursToBreakthrough" min="0" max="23" value="0" placeholder="å°æ™‚">
                </div>
                <div class="form-group">
                    <label for="minutesToBreakthrough">åˆ†é˜ï¼š</label>
                    <input type="number" id="minutesToBreakthrough" min="0" max="59" value="0" placeholder="åˆ†é˜">
                </div>
            </div>
            
            <div id="countdownContainer" style="display: none;">
                <div class="countdown-display">
                    <div>è·é›¢çªç ´é‚„æœ‰</div>
                    <div class="countdown-timer">
                        <span class="time-unit">
                            <span id="countdownDays" class="time-value">0</span>
                            <span class="time-label">å¤©</span>
                        </span>
                        <span class="time-unit">
                            <span id="countdownHours" class="time-value">0</span>
                            <span class="time-label">å°æ™‚</span>
                        </span>
                        <span class="time-unit">
                            <span id="countdownMinutes" class="time-value">0</span>
                            <span class="time-label">åˆ†é˜</span>
                        </span>
                        <span class="time-unit">
                            <span id="countdownSeconds" class="time-value">0</span>
                            <span class="time-label">ç§’</span>
                        </span>
                    </div>
                    <div class="beijing-time">
                        ç•¶å‰åŒ—äº¬æ™‚é–“ï¼š<span id="currentBeijingTime" class="current-time">00:00:00</span>
                    </div>
                    <div class="breakthrough-date-display">
                        é è¨ˆçªç ´æ™‚é–“ï¼š<span id="breakthroughDateDisplay" class="breakthrough-date-value">å°šæœªè¨­å®š</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="input-section">
                <h2 class="section-title">ç•¶å‰ç‹€æ…‹è¨­å®š</h2>
                
                <div class="form-group">
                    <label for="realm">é¸æ“‡ç•¶å‰å¢ƒç•Œï¼š</label>
                    <select id="realm">
                        <option value="äººç•Œ">äººç•Œ</option>
                        <option value="è¿”è™›">è¿”è™›</option>
                        <option value="åˆé«”">åˆé«”</option>
                        <option value="å¤§æˆ">å¤§æˆ</option>
                        <option value="æ¸¡åŠ«">æ¸¡åŠ«</option>
                        <option value="çœŸä»™" selected>çœŸä»™</option>
                        <option value="é‡‘ä»™">é‡‘ä»™</option>
                        <option value="å¤ªä¹™">å¤ªä¹™</option>
                        <option value="å¤§ç¾…">å¤§ç¾…</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <div class="attribute-levels-container">
                        <label>å±¬æ€§ç­‰ç´šè¨­å®šï¼ˆå¯è¨­å®šç›®æ¨™ç­‰ç´šèˆ‡å‡ç´šå„ªå…ˆé †åºï¼‰ï¼š</label>
                        <table class="attribute-table">
                            <thead>
                                <tr>
                                    <th>å±¬æ€§</th>
                                    <th>ç•¶å‰ç­‰ç´š</th>
                                    <th>ç›®æ¨™ç­‰ç´š</th>
                                    <th class="priority-cell">å‡ç´šå„ªå…ˆé †åº</th>
                                </tr>
                            </thead>
                            <tbody id="attributeTable">
                                <tr>
                                    <td>ä¿®ç‚º</td>
                                    <td>
                                        <select id="cultivationCurrent" class="level-select">
                                            <!-- é¸é …å°‡ç”±JavaScriptç”Ÿæˆ -->
                                        </select>
                                    </td>
                                    <td>
                                        <select id="cultivationTarget" class="level-select">
                                            <!-- é¸é …å°‡ç”±JavaScriptç”Ÿæˆ -->
                                        </select>
                                    </td>
                                    <td>
                                        <select id="cultivationPriority" class="priority-select">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <td>å“è³ª</td>
                                    <td>
                                        <select id="qualityCurrent" class="level-select">
                                            <!-- é¸é …å°‡ç”±JavaScriptç”Ÿæˆ -->
                                        </select>
                                    </td>
                                    <td>
                                        <select id="qualityTarget" class="level-select">
                                            <!-- é¸é …å°‡ç”±JavaScriptç”Ÿæˆ -->
                                        </select>
                                    </td>
                                    <td>
                                        <select id="qualityPriority" class="priority-select">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <td>éˆæ¹§</td>
                                    <td>
                                        <select id="spiritFlowCurrent" class="level-select">
                                            <!-- é¸é …å°‡ç”±JavaScriptç”Ÿæˆ -->
                                        </select>
                                    </td>
                                    <td>
                                        <select id="spiritFlowTarget" class="level-select">
                                            <!-- é¸é …å°‡ç”±JavaScriptç”Ÿæˆ -->
                                        </select>
                                    </td>
                                    <td>
                                        <select id="spiritFlowPriority" class="priority-select">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <td>é«˜å“</td>
                                    <td>
                                        <select id="highQualityCurrent" class="level-select">
                                            <!-- é¸é …å°‡ç”±JavaScriptç”Ÿæˆ -->
                                        </select>
                                    </td>
                                    <td>
                                        <select id="highQualityTarget" class="level-select">
                                            <!-- é¸é …å°‡ç”±JavaScriptç”Ÿæˆ -->
                                        </select>
                                    </td>
                                    <td>
                                        <select id="highQualityPriority" class="priority-select">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                        </select>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="priority-info">å„ªå…ˆé †åº 1 ç‚ºæœ€å…ˆå‡ç´šï¼Œ4 ç‚ºæœ€å¾Œå‡ç´š</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="monsterSelect">è¬å¦–é¦–é ˜èˆ‡å¯ç²å¦–é­„ï¼š</label>
                    <select id="monsterSelect">
                        <!-- é¸é …å°‡ç”±JavaScriptæ ¹æ“šå¢ƒç•Œç”Ÿæˆ -->
                    </select>
                    <div class="monster-select-info">
                        <span id="monsterPower">æˆ°åŠ›è¦æ±‚ï¼šç„¡</span>
                        <span id="monsterSouls">å¦–é­„ï¼š0</span>
                    </div>
                    <div class="data-source">*æ•¸æ“šåŸºæ–¼ç•¶å‰å¢ƒç•Œå¯æŒ‘æˆ°çš„è¬å¦–é¦–é ˜</div>
                </div>
                
                <div class="form-group">
                    <label for="tickets">é è¨ˆä½¿ç”¨è¬å¦–ä»¤æ•¸é‡ï¼š</label>
                    <input type="number" id="tickets" min="0" value="0">
                    <div class="info-text">æ¯å‘¨åŸºç¤3å ´è¬å¦–æŒ‘æˆ°ï¼Œä½¿ç”¨è¬å¦–ä»¤å¯å¢åŠ æŒ‘æˆ°å ´æ¬¡</div>
                </div>
                
                <div class="advance-options">
                    <div class="advance-title">é€²éšé¸é …ï¼š</div>
                    
                    <!-- ç§»é™¤è€ƒæ…®è¬å¦–é–‹æ”¾æ™‚é–“é¸é …ï¼Œæ”¹ç‚ºé»˜èªè€ƒæ…® -->
                    <div class="checkbox-container" style="display: none;">
                        <input type="checkbox" id="considerWeek" checked disabled>
                        <label for="considerWeek">è€ƒæ…®è¬å¦–é–‹æ”¾æ™‚é–“ï¼ˆé€±ä¸‰è‡³é€±æ—¥ï¼‰</label>
                    </div>
                    
                    <div class="checkbox-container">
                        <input type="checkbox" id="keepThreeBattles" checked>
                        <label for="keepThreeBattles">å˜—è©¦ç‚ºçªç ´ç•¶é€±ä¿ç•™3æ¬¡æŒ‘æˆ°æ©Ÿæœƒ</label>
                    </div>
                    
                    <div class="sunday-bonus-container">
                        <div class="sunday-bonus-title">é€±æ—¥çµç®—é¡å¤–å¦–é­„è¨­å®š</div>
                        
                        <div class="sunday-bonus-checkbox">
                            <input type="checkbox" id="includeSundayBonus">
                            <label for="includeSundayBonus">è€ƒæ…®é€±æ—¥23:59çµç®—å¯å¤šå¾—å¦–é­„</label>
                        </div>
                        
                        <div id="sundayBonusOptions" style="display: none;">
                            <div class="form-group">
                                <label for="sundayRank">é è¨ˆå¾ŒçºŒæ¯é€±æ’åï¼š</label>
                                <select id="sundayRank">
                                    <option value="1">ç¬¬1å (+300å¦–é­„)</option>
                                    <option value="2-5">ç¬¬2-5å (+240å¦–é­„)</option>
                                    <option value="6-10">ç¬¬6-10å (+180å¦–é­„)</option>
                                    <option value="11-20">ç¬¬11-20å (+120å¦–é­„)</option>
                                    <option value="21-50">ç¬¬21-50å (+90å¦–é­„)</option>
                                    <option value="51-100">ç¬¬51-100å (+60å¦–é­„)</option>
                                    <option value="101-200">ç¬¬101-200å (+30å¦–é­„)</option>
                                    <option value="other">200åä»¥å¾Œ (ç„¡é¡å¤–å¦–é­„)</option>
                                </select>
                                <div class="info-text">æ’åè¶Šé«˜ï¼Œé€±æ—¥çµç®—é¡å¤–å¦–é­„è¶Šå¤š</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="button-group">
                    <button id="calculateBtn">è¨ˆç®—å‡ç´šéœ€æ±‚</button>
                    <button id="resetBtn">é‡ç½®è¼¸å…¥</button>
                </div>
            </div>
            
            <div class="results-section">
                <h2 class="section-title">è¨ˆç®—çµæœ</h2>
                
                <div class="result-item">
                    <div class="result-title">å‡ç´šæ‰€éœ€ç¸½å¦–é­„</div>
                    <div class="result-value highlight" id="totalSouls">0</div>
                </div>
                
                <div class="souls-breakdown" id="soulsBreakdown" style="display: none;">
                    <div class="souls-breakdown-title">å¦–é­„ä¾†æºåˆ†æ</div>
                    <div class="souls-breakdown-item">
                        <span class="souls-breakdown-label">æ­£å¸¸è¬å¦–æŒ‘æˆ°å¦–é­„ï¼š</span>
                        <span class="souls-breakdown-value" id="normalSouls">0</span>
                    </div>
                    <div class="souls-breakdown-item">
                        <span class="souls-breakdown-label">é€±æ—¥çµç®—é¡å¤–å¦–é­„ï¼š</span>
                        <span class="souls-breakdown-value" id="sundayBonusSouls">0</span>
                    </div>
                    <div class="souls-breakdown-item">
                        <span class="souls-breakdown-label">ç¸½è¨ˆï¼š</span>
                        <span class="souls-breakdown-value" id="totalSoulsBreakdown">0</span>
                    </div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">é‚„éœ€è¦æŒ‘æˆ°è¬å¦–æ¬¡æ•¸</div>
                    <div class="result-value" id="totalBattles">0 å ´</div>
                    <div class="info-text">åŸºæ–¼ç•¶å‰æ¯å ´å¯ç²å¦–é­„è¨ˆç®—</div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">è€ƒæ…®è¬å¦–ä»¤å¾Œé‚„éœ€å ´æ¬¡</div>
                    <div class="result-value" id="battlesWithTickets">0 å ´</div>
                    <div class="info-text">ä½¿ç”¨é è¨ˆè¬å¦–ä»¤å¾Œä»éœ€æŒ‘æˆ°çš„æ¬¡æ•¸</div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">å‡ç´šæ‰€éœ€æ™‚é–“ï¼ˆå‘¨ï¼‰</div>
                    <div class="result-value" id="weeksNeeded">0 å‘¨</div>
                    <div class="info-text">æŒ‰æ¯å‘¨3å ´è¨ˆç®—</div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">å„å±¬æ€§å‡ç´šéœ€æ±‚ï¼ˆæŒ‰å„ªå…ˆé †åºï¼‰</div>
                    <table class="breakdown-table">
                        <thead>
                            <tr>
                                <th>å±¬æ€§</th>
                                <th>ç•¶å‰ç­‰ç´š</th>
                                <th>ç›®æ¨™ç­‰ç´š</th>
                                <th>æ‰€éœ€å¦–é­„</th>
                                <th>å‡ç´šé †åº</th>
                            </tr>
                        </thead>
                        <tbody id="breakdownTable">
                            <!-- æ•¸æ“šå°‡ç”±JavaScriptå¡«å…… -->
                        </tbody>
                    </table>
                </div>
                
                <div id="sundayBonusResult" class="sunday-bonus-item" style="display: none;">
                    <div class="sunday-bonus-label">é€±æ—¥çµç®—é¡å¤–å¦–é­„</div>
                    <div class="sunday-bonus-value" id="sundayBonusTotal">0</div>
                    <div class="info-text">æ­¤éƒ¨åˆ†å¦–é­„ç‚ºé€±æ—¥çµç®—é¡å¤–ç²å¾—</div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">è·é›¢çªç ´å¯æŒ‘æˆ°æ¬¡æ•¸</div>
                    <div class="result-value" id="battlesBeforeBreakthrough">0 å ´</div>
                    <div class="info-text">åœ¨çªç ´å‰å¯å®Œæˆçš„è¬å¦–æŒ‘æˆ°æ¬¡æ•¸ï¼ˆé€±ä¸‰è‡³é€±æ—¥ï¼‰</div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">èƒ½å¦åœ¨çªç ´å‰å‡æ»¿</div>
                    <div class="result-value" id="canCompleteBeforeBreakthrough">--</div>
                    <div id="breakthroughMessage"></div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">çªç ´ç•¶é€±è¦åŠƒ</div>
                    <div id="breakthroughWeekPlan">--</div>
                    <div id="weekPlanDetails"></div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">æœ€ä½³æŒ‘æˆ°ç­–ç•¥</div>
                    <div id="strategyTips">--</div>
                </div>
            </div>
        </div>
        
        <!-- æ–°å¢å­˜æª”åŠŸèƒ½å€åŸŸ -->
        <div class="save-section">
            <h2 class="section-title">æ•¸æ“šå­˜æª”åŠŸèƒ½</h2>
            <div class="save-slots" id="saveSlots">
                <!-- ä¸‰å€‹å­˜æª”æ§½å°‡ç”±JavaScriptç”Ÿæˆ -->
            </div>
            <div class="save-info">
                * æ•¸æ“šå°‡ä¿å­˜åœ¨æ‚¨çš„ç€è¦½å™¨ä¸­ï¼Œæ¸…é™¤ç€è¦½å™¨æ•¸æ“šå°‡æœƒåˆªé™¤å­˜æª”
            </div>
        </div>
        
        <div class="note-box">
            <div class="note-title">ä½¿ç”¨èªªæ˜èˆ‡æ³¨æ„äº‹é …ï¼š</div>
            <p>1. æœ¬å·¥å…·æ•¸æ“šåŸºæ–¼ä¸€å¿µé€é™å®˜æ–¹æä¾›çš„åŒ–éˆå°å‡ç´šæ¶ˆè€—è¡¨ï¼Œåƒ…ä¾›åƒè€ƒã€‚</p>
            <p>2. è¬å¦–æŒ‘æˆ°æ¯é€±ä¸‰è‡³é€±æ—¥é–‹æ”¾ï¼Œé€±æ—¥23:59çµç®—ï¼Œå¯è€ƒæ…®åœ¨çµç®—å‰æŒ‘æˆ°ä»¥ç²å¾—æ›´å¤šå¦–é­„ã€‚</p>
            <p>3. çªç ´å¤§å¢ƒç•Œç•¶é€±å¯ä»¥æå‰å­˜å„²æŒ‘æˆ°æ¬¡æ•¸ï¼Œå»ºè­°åœ¨çªç ´å‰ä¿ç•™3æ¬¡æŒ‘æˆ°æ©Ÿæœƒã€‚</p>
            <p>4. çœŸä»™ã€é‡‘ä»™ã€å¤ªä¹™ã€å¤§ç¾…å››å€‹å¤§å¢ƒç•Œçš„åŒ–éˆå°å‡ç´šæ¶ˆè€—ç›¸åŒã€‚</p>
            <p>5. é€±æ—¥çµç®—é¡å¤–å¦–é­„ï¼šç¬¬1å+300å¦–é­„ï¼Œç¬¬2-5å+240å¦–é­„ï¼Œç¬¬6-10å+180å¦–é­„ï¼Œç¬¬11-20å+120å¦–é­„ï¼Œç¬¬21-50å+90å¦–é­„ï¼Œç¬¬51-100å+60å¦–é­„ï¼Œç¬¬101-200å+30å¦–é­„ã€‚</p>
            <p>6. é€±æ—¥çµç®—é¡å¤–å¦–é­„æœƒå–®ç¨è¨ˆç®—ï¼Œä½œç‚ºé€±æ—¥çš„é¡å¤–çå‹µï¼Œæ¯é€±åªè¨ˆç®—1æ¬¡ã€‚</p>
            <p>7. ä½¿ç”¨å­˜æª”åŠŸèƒ½å¯ä¿å­˜ç•¶å‰è¨­å®šï¼Œæ–¹ä¾¿ä¸‹æ¬¡ä½¿ç”¨æ™‚å¿«é€Ÿè¼‰å…¥ã€‚</p>
            <p>8. é–‹ç®±å­æ‰€å¾—çš„å¦–é­„è«‹è‡ªè¡Œè¨ˆç®—ã€‚</p>
        </div>
        
        <footer>
            <p>ä¸€å¿µé€é™åŒ–éˆè‡ºå‡ç´šè¨ˆç®—å™¨ | æ•¸æ“šä¾†æºï¼šå®˜æ–¹åŒ–éˆå°æ¶ˆè€—è¡¨ | æœ¬å·¥å…·åƒ…ä¾›éŠæˆ²åƒè€ƒ</p>
            <p>Â© 2023 ä¸€å¿µé€é™æ”»ç•¥å·¥å…· | é©é…æ‰‹æ©Ÿã€å¹³æ¿ã€é›»è…¦</p>
        </footer>
    </div>

    <script>
        // åŒ–éˆè‡ºå‡ç´šæ¶ˆè€—æ•¸æ“š
        const soulData = {
            "äººç•Œ": {
                "ä¿®ç‚º": [20,20,35,35,35,45,45,45,55,55,75,75,75,100,100,120,120,120,140,140,175,175,175,210,210,240,240,285,285,350],
                "å“è³ª": [20,20,35,35,35,45,45,45,55,55,75,75,75,100,100,120,120,120,140,140,175,175,175,210,210,240,240,285,285,350],
                "éˆæ¹§": [25,25,30,30,30,35,35,35,45,45,55,55,55,70,70,80,80,80,90,90,100,100,100,115,115,125,125,150,150,180],
                "é«˜å“": [20,20,25,25,25,30,30,30,35,35,45,45,45,55,55,65,65,65,75,75,80,80,80,90,90,100,100,120,120,145]
            },
            "è¿”è™›": {
                "ä¿®ç‚º": [25,25,35,35,35,45,45,45,60,60,80,80,80,105,105,125,125,125,150,150,185,185,185,220,220,255,255,300,300,370],
                "å“è³ª": [35,35,50,50,50,70,70,70,85,85,120,120,120,155,155,190,190,190,225,225,280,280,280,330,330,380,380,450,450,555],
                "éˆæ¹§": [35,35,45,45,45,60,60,60,70,70,90,90,90,110,110,125,125,125,145,145,160,160,160,180,180,200,200,235,235,290],
                "é«˜å“": [25,25,35,35,35,40,40,40,50,50,65,65,65,75,75,90,90,90,100,100,115,115,115,125,125,140,140,165,165,200]
            },
            "åˆé«”": {
                "ä¿®ç‚º": [30,30,45,45,45,60,60,60,75,75,105,105,105,135,135,165,165,165,190,190,235,235,235,280,280,325,325,385,385,475],
                "å“è³ª": [45,45,65,65,65,90,90,90,110,110,155,155,155,200,200,245,245,245,290,290,355,355,355,420,420,490,490,575,575,710],
                "éˆæ¹§": [45,45,60,60,60,75,75,75,90,90,115,115,115,140,140,160,160,160,185,185,210,210,210,230,230,255,255,300,300,370],
                "é«˜å“": [30,30,40,40,40,50,50,50,65,65,80,80,80,95,95,115,115,115,130,130,145,145,145,160,160,180,180,210,210,260]
            },
            "å¤§æˆ": {
                "ä¿®ç‚º": [30,30,45,45,45,60,60,60,75,75,105,105,105,135,135,165,165,165,190,190,235,235,235,280,280,325,325,385,385,475],
                "å“è³ª": [45,45,65,65,65,90,90,90,110,110,155,155,155,200,200,245,245,245,290,290,355,355,355,420,420,490,490,575,575,710],
                "éˆæ¹§": [45,45,60,60,60,75,75,75,90,90,115,115,115,140,140,160,160,160,185,185,210,210,210,230,230,255,255,300,300,370],
                "é«˜å“": [30,30,40,40,40,50,50,50,65,65,80,80,80,95,95,115,115,115,130,130,145,145,145,160,160,180,180,210,210,260]
            },
            "æ¸¡åŠ«": {
                "ä¿®ç‚º": [40,40,60,60,60,80,80,80,100,100,140,140,140,180,180,220,220,220,265,265,325,325,325,385,385,445,445,525,525,645],
                "å“è³ª": [60,60,90,90,90,120,120,120,150,150,210,210,210,275,275,335,335,335,395,395,485,485,485,575,575,665,665,790,790,970],
                "éˆæ¹§": [65,65,80,80,80,100,100,100,125,125,155,155,155,190,190,220,220,220,250,250,285,285,285,315,315,345,345,410,410,505],
                "é«˜å“": [45,45,55,55,55,70,70,70,90,90,110,110,110,130,130,155,155,155,175,175,200,200,200,220,220,245,245,285,285,355]
            },
            "çœŸä»™": {
                "ä¿®ç‚º": [60,60,90,90,90,115,115,115,145,145,205,205,205,265,265,320,320,320,380,380,465,465,465,555,555,640,640,760,760,935],
                "å“è³ª": [90,90,130,130,130,175,175,175,220,220,305,305,305,395,395,480,480,480,570,570,700,700,700,830,830,965,965,1140,1140,1400],
                "éˆæ¹§": [90,90,120,120,120,145,145,145,180,180,230,230,230,275,275,320,320,320,365,365,410,410,410,455,455,500,500,590,590,730],
                "é«˜å“": [65,65,85,85,85,100,100,100,125,125,160,160,160,190,190,225,225,225,255,255,285,285,285,320,320,350,350,415,415,510]
            },
            "é‡‘ä»™": {
                "ä¿®ç‚º": [60,60,90,90,90,115,115,115,145,145,205,205,205,265,265,320,320,320,380,380,465,465,465,555,555,640,640,760,760,935],
                "å“è³ª": [90,90,130,130,130,175,175,175,220,220,305,305,305,395,395,480,480,480,570,570,700,700,700,830,830,965,965,1140,1140,1400],
                "éˆæ¹§": [90,90,120,120,120,145,145,145,180,180,230,230,230,275,275,320,320,320,365,365,410,410,410,455,455,500,500,590,590,730],
                "é«˜å“": [65,65,85,85,85,100,100,100,125,125,160,160,160,190,190,225,225,225,255,255,285,285,285,320,320,350,350,415,415,510]
            },
            "å¤ªä¹™": {
                "ä¿®ç‚º": [60,60,90,90,90,115,115,115,145,145,205,205,205,265,265,320,320,320,380,380,465,465,465,555,555,640,640,760,760,935],
                "å“è³ª": [90,90,130,130,130,175,175,175,220,220,305,305,305,395,395,480,480,480,570,570,700,700,700,830,830,965,965,1140,1140,1400],
                "éˆæ¹§": [90,90,120,120,120,145,145,145,180,180,230,230,230,275,275,320,320,320,365,365,410,410,410,455,455,500,500,590,590,730],
                "é«˜å“": [65,65,85,85,85,100,100,100,125,125,160,160,160,190,190,225,225,225,255,255,285,285,285,320,320,350,350,415,415,510]
            },
            "å¤§ç¾…": {
                "ä¿®ç‚º": [60,60,90,90,90,115,115,115,145,145,205,205,205,265,265,320,320,320,380,380,465,465,465,555,555,640,640,760,760,935],
                "å“è³ª": [90,90,130,130,130,175,175,175,220,220,305,305,305,395,395,480,480,480,570,570,700,700,700,830,830,965,965,1140,1140,1400],
                "éˆæ¹§": [90,90,120,120,120,145,145,145,180,180,230,230,230,275,275,320,320,320,365,365,410,410,410,455,455,500,500,590,590,730],
                "é«˜å“": [65,65,85,85,85,100,100,100,125,125,160,160,160,190,190,225,225,225,255,255,285,285,285,320,320,350,350,415,415,510]
            }
        };

        // å„å¢ƒç•Œè¬å¦–é¦–é ˜èˆ‡å¦–é­„æ•¸æ“š
        const monsterData = {
            "äººç•Œ": [
                { name: "çµä¸¹ - ç„çŒ¿ç‹", power: "ç„¡", souls: 80 },
                { name: "å…ƒå¬° - ä¿®ç¾…ç‹", power: "4000è¬", souls: 100 },
                { name: "å…ƒå¬° - é¯¤éµ¬å¦–ç‹", power: "7000è¬", souls: 120 },
                { name: "åŒ–ç¥ - é‚ªçœ¼è›‡ç‹", power: "ç„¡", souls: 150 },
                { name: "åŒ–ç¥ - é‡‘è§’è™ç‹", power: "4å„„", souls: 200 },
                { name: "åŒ–ç¥ - ç´«ç„°å •å¦–ç‹", power: "6å„„", souls: 250 },
                { name: "åŒ–ç¥ - ç¢§çœ¼é’ç…ç‹", power: "8å„„", souls: 320 }
            ],
            "è¿”è™›": [
                { name: "å»£å¹½å¦–ç‹", power: "ç„¡", souls: 100 },
                { name: "å‡Œéœ„é¶´ç‹", power: "45å„„", souls: 150 },
                { name: "èµ¤ç„°ç…ç‹", power: "60å„„", souls: 200 },
                { name: "å¯’ç„çœŸé¾ç‹", power: "75å„„", souls: 250 },
                { name: "äº”è¡Œå¤©å¦–ç‹", power: "90å„„", souls: 320 }
            ],
            "åˆé«”": [
                { name: "é€šå¤©è ±ç‹", power: "ç„¡", souls: 100 },
                { name: "ç†¾ç«éˆç‹", power: "250å„„", souls: 150 },
                { name: "çŠ°ç‹³å¦–ç‹", power: "300å„„", souls: 200 },
                { name: "å¤§è’å¤©ç¸ç‹", power: "380å„„", souls: 250 },
                { name: "èµ¤ç›®é‡‘çŒŠç‹", power: "450å„„", souls: 320 }
            ],
            "å¤§æˆ": [
                { name: "é’é¢é¬¼ç‹", power: "ç„¡", souls: 100 },
                { name: "ç ç‰™é¬¼ç‹", power: "800å„„", souls: 150 },
                { name: "ç½ªå‡°å¦–ç‹", power: "1100å„„", souls: 200 },
                { name: "å·«ç„°å·¨å¦–ç‹", power: "1400å„„", souls: 250 },
                { name: "é€†é“ä½‘è–ç‹", power: "1700å„„", souls: 320 }
            ],
            "æ¸¡åŠ«": [
                { name: "å½Œå¤­è¶ç‹", power: "ç„¡", souls: 100 },
                { name: "è’¼ç„å·«ç‹", power: "3000å„„", souls: 150 },
                { name: "å˜¯æœˆç‹¼ç‹", power: "3600å„„", souls: 200 },
                { name: "æ·±æ·µæ°äºº", power: "4200å„„", souls: 250 },
                { name: "è’¼éˆå¤”ç‰›ç‹", power: "5000å„„", souls: 320 }
            ],
            "çœŸä»™": [
                { name: "æœ±å­å¤©ç‹", power: "ç„¡", souls: 100 },
                { name: "é¢¨éˆå¤©ç‰", power: "1.0è¬å„„", souls: 150 },
                { name: "å…©é»ƒå¤©ç‹", power: "1.2è¬å„„", souls: 200 },
                { name: "æ¶…æ§ƒé³³ç‹", power: "1.4è¬å„„", souls: 250 },
                { name: "ä¹éœ„éº’éºŸä¸»", power: "1.6è¬å„„", souls: 320 },
                { name: "é­”å°‡ç›¸æŸ³", power: "1.8è¬å„„", souls: 400 }
            ],
            "é‡‘ä»™": [
                { name: "ç‹å®¿å¤©ç‹", power: "ç„¡", souls: 100 },
                { name: "é¬¼å®¿å¤©ç‹", power: "4è¬å„„", souls: 150 },
                { name: "è’¼æ¡‚å¤©ç‹", power: "4.5è¬å„„", souls: 200 },
                { name: "æ¸¡å„é¾ç‹", power: "5è¬å„„", souls: 250 },
                { name: "é‡‘ç¿…å¤§éµ¬ç‹", power: "5.5è¬å„„", souls: 320 },
                { name: "é­”å°‡å¾Œå¿", power: "6è¬å„„", souls: 400 }
            ],
            "å¤ªä¹™": [
                { name: "é‡‘çƒå¤©ç‹", power: "ç„¡", souls: 100 },
                { name: "æ­¸å¢Ÿéµ¬ç‹", power: "11è¬å„„", souls: 150 },
                { name: "ç¥¸æ–—å¤©ç‹", power: "13è¬å„„", souls: 200 },
                { name: "å¾¡é¾œå¤©ç‹", power: "15è¬å„„", souls: 250 },
                { name: "è¦†æµ·è­é¾ç‹", power: "17è¬å„„", souls: 320 },
                { name: "é­”å°‡ç¦ºç–†", power: "20è¬å„„", souls: 400 }
            ],
            "å¤§ç¾…": [
                { name: "éŠé‚å¤©ç‹", power: "ç„¡", souls: 100 },
                { name: "å®šé­‚å¤©ç‹", power: "32è¬å„„", souls: 150 },
                { name: "å“®è’è™ºç‹", power: "40è¬å„„", souls: 200 },
                { name: "é»„åº­é¬¼é¢ç‹", power: "48è¬å„„", souls: 250 },
                { name: "å…‰é™°è¬ç¸ä¸»", power: "56è¬å„„", souls: 320 },
                { name: "é­”å°‡éƒå’", power: "64è¬å„„", souls: 400 }
            ]
        };

        // é€±æ—¥çµç®—é¡å¤–å¦–é­„æ•¸æ“š
        const sundayBonus = {
            "1": 300, // ç¬¬1å
            "2-5": 240, // ç¬¬2-5å
            "6-10": 180, // ç¬¬6-10å
            "11-20": 120, // ç¬¬11-20å
            "21-50": 90, // ç¬¬21-50å
            "51-100": 60, // ç¬¬51-100å
            "101-200": 30, // ç¬¬101-200å
            "other": 0 // 200åä»¥å¾Œ
        };

        // å­˜æª”ç›¸é—œè®Šæ•¸
        const SAVE_SLOTS_COUNT = 3;
        let currentSaveSlot = null; // ç•¶å‰é¸ä¸­çš„å­˜æª”æ§½
        let saveData = {}; // å­˜æª”æ•¸æ“š

        // DOMå…ƒç´ 
        const realmSelect = document.getElementById('realm');
        
        // å±¬æ€§ç­‰ç´šç›¸é—œå…ƒç´ 
        const cultivationCurrentSelect = document.getElementById('cultivationCurrent');
        const cultivationTargetSelect = document.getElementById('cultivationTarget');
        const cultivationPrioritySelect = document.getElementById('cultivationPriority');
        
        const qualityCurrentSelect = document.getElementById('qualityCurrent');
        const qualityTargetSelect = document.getElementById('qualityTarget');
        const qualityPrioritySelect = document.getElementById('qualityPriority');
        
        const spiritFlowCurrentSelect = document.getElementById('spiritFlowCurrent');
        const spiritFlowTargetSelect = document.getElementById('spiritFlowTarget');
        const spiritFlowPrioritySelect = document.getElementById('spiritFlowPriority');
        
        const highQualityCurrentSelect = document.getElementById('highQualityCurrent');
        const highQualityTargetSelect = document.getElementById('highQualityTarget');
        const highQualityPrioritySelect = document.getElementById('highQualityPriority');
        
        // è¬å¦–é¦–é ˜ç›¸é—œå…ƒç´ 
        const monsterSelect = document.getElementById('monsterSelect');
        const monsterPowerEl = document.getElementById('monsterPower');
        const monsterSoulsEl = document.getElementById('monsterSouls');
        
        // è¬å¦–ä»¤ç›¸é—œå…ƒç´ 
        const ticketsInput = document.getElementById('tickets');
        
        // æ™‚é–“ç›¸é—œå…ƒç´ 
        const daysToBreakthroughInput = document.getElementById('daysToBreakthrough');
        const hoursToBreakthroughInput = document.getElementById('hoursToBreakthrough');
        const minutesToBreakthroughInput = document.getElementById('minutesToBreakthrough');
        const countdownContainer = document.getElementById('countdownContainer');
        const countdownDaysEl = document.getElementById('countdownDays');
        const countdownHoursEl = document.getElementById('countdownHours');
        const countdownMinutesEl = document.getElementById('countdownMinutes');
        const countdownSecondsEl = document.getElementById('countdownSeconds');
        const currentBeijingTimeEl = document.getElementById('currentBeijingTime');
        const breakthroughDateDisplayEl = document.getElementById('breakthroughDateDisplay');
        const estimatedBreakthroughDateEl = document.getElementById('estimatedBreakthroughDate');
        const estimatedDateContainer = document.getElementById('estimatedDateContainer');
        
        // é€±æ—¥çµç®—ç›¸é—œå…ƒç´ 
        const includeSundayBonusCheckbox = document.getElementById('includeSundayBonus');
        const sundayBonusOptions = document.getElementById('sundayBonusOptions');
        const sundayRankSelect = document.getElementById('sundayRank');
        
        // é€²éšé¸é …å…ƒç´ 
        const considerWeekCheckbox = document.getElementById('considerWeek');
        const keepThreeBattlesCheckbox = document.getElementById('keepThreeBattles');
        
        // çµæœå…ƒç´ 
        const totalSoulsEl = document.getElementById('totalSouls');
        const soulsBreakdownEl = document.getElementById('soulsBreakdown');
        const normalSoulsEl = document.getElementById('normalSouls');
        const sundayBonusSoulsEl = document.getElementById('sundayBonusSouls');
        const totalSoulsBreakdownEl = document.getElementById('totalSoulsBreakdown');
        const totalBattlesEl = document.getElementById('totalBattles');
        const battlesWithTicketsEl = document.getElementById('battlesWithTickets');
        const weeksNeededEl = document.getElementById('weeksNeeded');
        const breakdownTableEl = document.getElementById('breakdownTable');
        const sundayBonusResultEl = document.getElementById('sundayBonusResult');
        const sundayBonusTotalEl = document.getElementById('sundayBonusTotal');
        
        // æ™‚é–“è¦åŠƒçµæœå…ƒç´ 
        const battlesBeforeBreakthroughEl = document.getElementById('battlesBeforeBreakthrough');
        const canCompleteBeforeBreakthroughEl = document.getElementById('canCompleteBeforeBreakthrough');
        const breakthroughMessageEl = document.getElementById('breakthroughMessage');
        const breakthroughWeekPlanEl = document.getElementById('breakthroughWeekPlan');
        const weekPlanDetailsEl = document.getElementById('weekPlanDetails');
        const strategyTipsEl = document.getElementById('strategyTips');
        
        // å­˜æª”å…ƒç´ 
        const saveSlotsContainer = document.getElementById('saveSlots');
        
        // æŒ‰éˆ•
        const calculateBtn = document.getElementById('calculateBtn');
        const resetBtn = document.getElementById('resetBtn');
        
        // ç•¶å‰é¸æ“‡çš„å¦–é­„æ•¸é‡
        let currentSoulsPerBattle = 0;
        
        // å€’æ•¸è¨ˆæ™‚å™¨è®Šæ•¸
        let countdownTimer = null;
        let breakthroughTime = null;
        
        // æ ¼å¼åŒ–æ—¥æœŸæ™‚é–“é¡¯ç¤º
        function formatDateTime(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            const seconds = String(date.getSeconds()).padStart(2, '0');
            
            // æ˜ŸæœŸå¹¾
            const weekdays = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
            const weekday = weekdays[date.getDay()];
            
            return `${year}å¹´${month}æœˆ${day}æ—¥ é€±${weekday} ${hours}:${minutes}:${seconds}`;
        }
        
        // æ ¼å¼åŒ–ç°¡çŸ­æ—¥æœŸé¡¯ç¤º
        function formatShortDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            
            // æ˜ŸæœŸå¹¾
            const weekdays = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
            const weekday = weekdays[date.getDay()];
            
            return `${year}/${month}/${day} é€±${weekday} ${hours}:${minutes}`;
        }
        
        // åˆå§‹åŒ–å­˜æª”ç³»çµ±
        function initSaveSystem() {
            // å¾æœ¬åœ°å­˜å„²åŠ è¼‰å­˜æª”æ•¸æ“š
            const savedData = localStorage.getItem('yiNianXiaoYao_SaveData');
            if (savedData) {
                try {
                    saveData = JSON.parse(savedData);
                } catch (e) {
                    console.error('è®€å–å­˜æª”æ•¸æ“šå¤±æ•—:', e);
                    saveData = {};
                }
            }
            
            // åˆå§‹åŒ–å­˜æª”æ§½
            renderSaveSlots();
        }
        
        // æ¸²æŸ“å­˜æª”æ§½
        function renderSaveSlots() {
            let slotsHTML = '';
            
            for (let i = 0; i < SAVE_SLOTS_COUNT; i++) {
                const slotId = `slot${i}`;
                const slotData = saveData[slotId] || null;
                const slotName = slotData ? slotData.name : `å­˜æª”ä½ ${i + 1}`;
                const slotContent = slotData ? 
                    `å¢ƒç•Œ: ${slotData.realm}<br>ä¿®ç‚º: ${slotData.cultivationCurrent}/${slotData.cultivationTarget}<br>æ™‚é–“: ${slotData.daysToBreakthrough}å¤©${slotData.hoursToBreakthrough}å°æ™‚` :
                    'ç©ºå­˜æª”ä½';
                
                const isActive = currentSaveSlot === slotId;
                
                slotsHTML += `
                    <div class="save-slot ${isActive ? 'active' : ''}" id="${slotId}">
                        <div class="save-slot-header">
                            <div class="save-slot-name" id="slotName${i}">${slotName}</div>
                            <button class="save-slot-btn rename" onclick="renameSaveSlot('${slotId}')">æ”¹å</button>
                        </div>
                        <div class="save-slot-content">
                            ${slotContent}
                        </div>
                        <div class="save-slot-actions">
                            <button class="save-slot-btn load" onclick="loadSaveSlot('${slotId}')">è¼‰å…¥</button>
                            <button class="save-slot-btn save" onclick="saveToSlot('${slotId}')">ä¿å­˜</button>
                            <button class="save-slot-btn delete" onclick="deleteSaveSlot('${slotId}')">åˆªé™¤</button>
                        </div>
                    </div>
                `;
            }
            
            saveSlotsContainer.innerHTML = slotsHTML;
        }
        
        // é‡å‘½åå­˜æª”
        function renameSaveSlot(slotId) {
            const slotData = saveData[slotId];
            const currentName = slotData ? slotData.name : `å­˜æª”ä½ ${parseInt(slotId.replace('slot', '')) + 1}`;
            
            const newName = prompt('è«‹è¼¸å…¥æ–°çš„å­˜æª”åç¨±ï¼š', currentName);
            if (newName && newName.trim()) {
                if (!saveData[slotId]) {
                    saveData[slotId] = {};
                }
                saveData[slotId].name = newName.trim();
                saveToLocalStorage();
                renderSaveSlots();
            }
        }
        
        // è¼‰å…¥å­˜æª”
        function loadSaveSlot(slotId) {
            const slotData = saveData[slotId];
            if (!slotData) {
                alert('æ­¤å­˜æª”ä½ç‚ºç©ºï¼Œç„¡æ³•è¼‰å…¥ï¼');
                return;
            }
            
            // è¨­å®šç•¶å‰å­˜æª”æ§½
            currentSaveSlot = slotId;
            
            // è¼‰å…¥æ•¸æ“šåˆ°è¡¨å–®
            realmSelect.value = slotData.realm || 'çœŸä»™';
            
            cultivationCurrentSelect.value = slotData.cultivationCurrent || 0;
            cultivationTargetSelect.value = slotData.cultivationTarget || 30;
            cultivationPrioritySelect.value = slotData.cultivationPriority || 1;
            
            qualityCurrentSelect.value = slotData.qualityCurrent || 0;
            qualityTargetSelect.value = slotData.qualityTarget || 30;
            qualityPrioritySelect.value = slotData.qualityPriority || 2;
            
            spiritFlowCurrentSelect.value = slotData.spiritFlowCurrent || 0;
            spiritFlowTargetSelect.value = slotData.spiritFlowTarget || 30;
            spiritFlowPrioritySelect.value = slotData.spiritFlowPriority || 3;
            
            highQualityCurrentSelect.value = slotData.highQualityCurrent || 0;
            highQualityTargetSelect.value = slotData.highQualityTarget || 30;
            highQualityPrioritySelect.value = slotData.highQualityPriority || 4;
            
            ticketsInput.value = slotData.tickets || 0;
            
            daysToBreakthroughInput.value = slotData.daysToBreakthrough || 0;
            hoursToBreakthroughInput.value = slotData.hoursToBreakthrough || 0;
            minutesToBreakthroughInput.value = slotData.minutesToBreakthrough || 0;
            
            includeSundayBonusCheckbox.checked = slotData.includeSundayBonus || false;
            sundayRankSelect.value = slotData.sundayRank || '1';
            
            keepThreeBattlesCheckbox.checked = slotData.keepThreeBattles !== false;
            
            // æ›´æ–°è¬å¦–é¸æ“‡
            initMonsterSelect();
            
            // è¨­ç½®ç‰¹å®šçš„è¬å¦–é¦–é ˜
            if (slotData.monsterSelect) {
                monsterSelect.value = slotData.monsterSelect;
                updateMonsterSelect();
            }
            
            // æ›´æ–°é¡¯ç¤º
            renderSaveSlots();
            
            // é–‹å§‹å€’æ•¸è¨ˆæ™‚ä¸¦è¨ˆç®—
            startCountdown();
            calculateUpgradeNeeds();
            
            alert('å­˜æª”è¼‰å…¥æˆåŠŸï¼');
        }
        
        // ä¿å­˜åˆ°å­˜æª”æ§½
        function saveToSlot(slotId) {
            const saveName = saveData[slotId]?.name || `å­˜æª”ä½ ${parseInt(slotId.replace('slot', '')) + 1}`;
            
            if (!confirm(`ç¢ºå®šè¦ä¿å­˜åˆ°ã€Œ${saveName}ã€å—ï¼Ÿ`)) {
                return;
            }
            
            // æ”¶é›†ç•¶å‰è¡¨å–®æ•¸æ“š
            const formData = {
                name: saveName,
                realm: realmSelect.value,
                
                cultivationCurrent: parseInt(cultivationCurrentSelect.value) || 0,
                cultivationTarget: parseInt(cultivationTargetSelect.value) || 30,
                cultivationPriority: parseInt(cultivationPrioritySelect.value) || 1,
                
                qualityCurrent: parseInt(qualityCurrentSelect.value) || 0,
                qualityTarget: parseInt(qualityTargetSelect.value) || 30,
                qualityPriority: parseInt(qualityPrioritySelect.value) || 2,
                
                spiritFlowCurrent: parseInt(spiritFlowCurrentSelect.value) || 0,
                spiritFlowTarget: parseInt(spiritFlowTargetSelect.value) || 30,
                spiritFlowPriority: parseInt(spiritFlowPrioritySelect.value) || 3,
                
                highQualityCurrent: parseInt(highQualityCurrentSelect.value) || 0,
                highQualityTarget: parseInt(highQualityTargetSelect.value) || 30,
                highQualityPriority: parseInt(highQualityPrioritySelect.value) || 4,
                
                monsterSelect: monsterSelect.value,
                
                tickets: parseInt(ticketsInput.value) || 0,
                
                daysToBreakthrough: parseInt(daysToBreakthroughInput.value) || 0,
                hoursToBreakthrough: parseInt(hoursToBreakthroughInput.value) || 0,
                minutesToBreakthrough: parseInt(minutesToBreakthroughInput.value) || 0,
                
                includeSundayBonus: includeSundayBonusCheckbox.checked,
                sundayRank: sundayRankSelect.value,
                
                keepThreeBattles: keepThreeBattlesCheckbox.checked,
                
                saveTime: new Date().toLocaleString('zh-TW')
            };
            
            // ä¿å­˜åˆ°å­˜æª”æ•¸æ“š
            saveData[slotId] = formData;
            saveToLocalStorage();
            
            // æ›´æ–°ç•¶å‰å­˜æª”æ§½
            currentSaveSlot = slotId;
            
            // é‡æ–°æ¸²æŸ“å­˜æª”æ§½
            renderSaveSlots();
            
            alert('ä¿å­˜æˆåŠŸï¼');
        }
        
        // åˆªé™¤å­˜æª”
        function deleteSaveSlot(slotId) {
            const slotData = saveData[slotId];
            if (!slotData) {
                alert('æ­¤å­˜æª”ä½ç‚ºç©ºï¼Œç„¡æ³•åˆªé™¤ï¼');
                return;
            }
            
            if (!confirm(`ç¢ºå®šè¦åˆªé™¤ã€Œ${slotData.name}ã€å­˜æª”å—ï¼Ÿ`)) {
                return;
            }
            
            delete saveData[slotId];
            saveToLocalStorage();
            
            if (currentSaveSlot === slotId) {
                currentSaveSlot = null;
            }
            
            renderSaveSlots();
            alert('å­˜æª”åˆªé™¤æˆåŠŸï¼');
        }
        
        // ä¿å­˜åˆ°æœ¬åœ°å­˜å„²
        function saveToLocalStorage() {
            try {
                localStorage.setItem('yiNianXiaoYao_SaveData', JSON.stringify(saveData));
            } catch (e) {
                console.error('ä¿å­˜å­˜æª”æ•¸æ“šå¤±æ•—:', e);
                alert('ä¿å­˜å¤±æ•—ï¼Œå¯èƒ½æ˜¯å­˜å„²ç©ºé–“ä¸è¶³ï¼');
            }
        }
        
        // åˆå§‹åŒ–ç­‰ç´šä¸‹æ‹‰é¸å–®
        function initLevelSelects() {
            const levelOptions = [];
            for (let i = 0; i <= 30; i++) {
                levelOptions.push(`<option value="${i}">${i}ç´š</option>`);
            }
            
            // ä¿®ç‚º
            cultivationCurrentSelect.innerHTML = levelOptions.join('');
            cultivationTargetSelect.innerHTML = levelOptions.join('');
            cultivationCurrentSelect.value = 0;
            cultivationTargetSelect.value = 30;
            
            // å“è³ª
            qualityCurrentSelect.innerHTML = levelOptions.join('');
            qualityTargetSelect.innerHTML = levelOptions.join('');
            qualityCurrentSelect.value = 0;
            qualityTargetSelect.value = 30;
            
            // éˆæ¹§
            spiritFlowCurrentSelect.innerHTML = levelOptions.join('');
            spiritFlowTargetSelect.innerHTML = levelOptions.join('');
            spiritFlowCurrentSelect.value = 0;
            spiritFlowTargetSelect.value = 30;
            
            // é«˜å“
            highQualityCurrentSelect.innerHTML = levelOptions.join('');
            highQualityTargetSelect.innerHTML = levelOptions.join('');
            highQualityCurrentSelect.value = 0;
            highQualityTargetSelect.value = 30;
            
            // è¨­ç½®é»˜èªå„ªå…ˆé †åº
            cultivationPrioritySelect.value = 1;
            qualityPrioritySelect.value = 2;
            spiritFlowPrioritySelect.value = 3;
            highQualityPrioritySelect.value = 4;
        }
        
        // åˆå§‹åŒ–è¬å¦–é¦–é ˜é¸æ“‡
        function initMonsterSelect() {
            const realm = realmSelect.value;
            const monsters = monsterData[realm] || [];
            
            let options = '';
            monsters.forEach(monster => {
                // æ ¼å¼åŒ–é¡¯ç¤ºï¼šæˆ°åŠ› - åç¨± - å¦–é­„
                let displayText = '';
                if (monster.power === "ç„¡") {
                    displayText = `${monster.name} - ${monster.souls}å¦–é­„`;
                } else {
                    displayText = `${monster.power} - ${monster.name} - ${monster.souls}å¦–é­„`;
                }
                
                options += `<option value="${monster.souls}" data-power="${monster.power}" data-name="${monster.name}">${displayText}</option>`;
            });
            
            monsterSelect.innerHTML = options;
            
            // æ›´æ–°é¡¯ç¤º
            if (monsters.length > 0) {
                const firstMonster = monsters[0];
                monsterPowerEl.textContent = `æˆ°åŠ›è¦æ±‚ï¼š${firstMonster.power}`;
                monsterSoulsEl.textContent = `å¦–é­„ï¼š${firstMonster.souls}`;
                currentSoulsPerBattle = firstMonster.souls;
            }
        }
        
        // æ›´æ–°è¬å¦–é¦–é ˜é¸æ“‡
        function updateMonsterSelect() {
            const selectedValue = monsterSelect.value;
            const selectedOption = monsterSelect.options[monsterSelect.selectedIndex];
            const power = selectedOption.getAttribute('data-power');
            
            monsterPowerEl.textContent = `æˆ°åŠ›è¦æ±‚ï¼š${power}`;
            monsterSoulsEl.textContent = `å¦–é­„ï¼š${selectedValue}`;
            currentSoulsPerBattle = parseInt(selectedValue);
        }
        
        // ç²å–åŒ—äº¬æ™‚é–“å‡½æ•¸
        function getBeijingTime() {
            // åŒ—äº¬æ™‚é–“æ˜¯UTC+8
            const now = new Date();
            const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
            // è½‰æ›ç‚ºåŒ—äº¬æ™‚é–“ (UTC+8)
            return new Date(utc + (3600000 * 8));
        }
        
        // æ ¼å¼åŒ–æ™‚é–“é¡¯ç¤º
        function formatTime(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            const seconds = String(date.getSeconds()).padStart(2, '0');
            return `${year}å¹´${month}æœˆ${day}æ—¥ ${hours}:${minutes}:${seconds}`;
        }
        
        // æ›´æ–°ç•¶å‰åŒ—äº¬æ™‚é–“é¡¯ç¤º
        function updateBeijingTime() {
            const beijingTime = getBeijingTime();
            currentBeijingTimeEl.textContent = formatTime(beijingTime);
        }
        
        // æ›´æ–°é è¨ˆçªç ´æ—¥æœŸé¡¯ç¤º
        function updateBreakthroughDateDisplay() {
            const days = parseInt(daysToBreakthroughInput.value) || 0;
            const hours = parseInt(hoursToBreakthroughInput.value) || 0;
            const minutes = parseInt(minutesToBreakthroughInput.value) || 0;
            
            // å¦‚æœæ²’æœ‰è¨­å®šæ™‚é–“ï¼Œéš±è—æ—¥æœŸé¡¯ç¤º
            if (days === 0 && hours === 0 && minutes === 0) {
                estimatedDateContainer.style.display = "none";
                breakthroughDateDisplayEl.textContent = "å°šæœªè¨­å®š";
                return;
            }
            
            // è¨ˆç®—çªç ´æ™‚é–“ï¼ˆç•¶å‰åŒ—äº¬æ™‚é–“ + è¨­å®šçš„æ™‚é–“ï¼‰
            breakthroughTime = getBeijingTime();
            breakthroughTime.setDate(breakthroughTime.getDate() + days);
            breakthroughTime.setHours(breakthroughTime.getHours() + hours);
            breakthroughTime.setMinutes(breakthroughTime.getMinutes() + minutes);
            
            // æ›´æ–°é¡¯ç¤º
            const formattedDate = formatShortDate(breakthroughTime);
            estimatedBreakthroughDateEl.textContent = formattedDate;
            breakthroughDateDisplayEl.textContent = formatDateTime(breakthroughTime);
            
            // é¡¯ç¤ºæ—¥æœŸå®¹å™¨
            estimatedDateContainer.style.display = "block";
        }
        
        // é–‹å§‹å€’æ•¸è¨ˆæ™‚
        function startCountdown() {
            // æ¸…é™¤ç¾æœ‰çš„è¨ˆæ™‚å™¨
            if (countdownTimer) {
                clearInterval(countdownTimer);
            }
            
            const days = parseInt(daysToBreakthroughInput.value) || 0;
            const hours = parseInt(hoursToBreakthroughInput.value) || 0;
            const minutes = parseInt(minutesToBreakthroughInput.value) || 0;
            
            // æ›´æ–°é è¨ˆçªç ´æ—¥æœŸé¡¯ç¤º
            updateBreakthroughDateDisplay();
            
            // å¦‚æœæ²’æœ‰è¨­å®šæ™‚é–“ï¼Œéš±è—å€’æ•¸è¨ˆæ™‚
            if (days === 0 && hours === 0 && minutes === 0) {
                countdownContainer.style.display = "none";
                return;
            }
            
            // è¨ˆç®—çªç ´æ™‚é–“ï¼ˆç•¶å‰åŒ—äº¬æ™‚é–“ + è¨­å®šçš„æ™‚é–“ï¼‰
            breakthroughTime = getBeijingTime();
            breakthroughTime.setDate(breakthroughTime.getDate() + days);
            breakthroughTime.setHours(breakthroughTime.getHours() + hours);
            breakthroughTime.setMinutes(breakthroughTime.getMinutes() + minutes);
            
            // é¡¯ç¤ºå€’æ•¸è¨ˆæ™‚å®¹å™¨
            countdownContainer.style.display = "block";
            
            // ç«‹å³æ›´æ–°ä¸€æ¬¡å€’æ•¸è¨ˆæ™‚
            updateCountdown();
            
            // æ¯ç§’æ›´æ–°ä¸€æ¬¡å€’æ•¸è¨ˆæ™‚
            countdownTimer = setInterval(updateCountdown, 1000);
        }
        
        // æ›´æ–°å€’æ•¸è¨ˆæ™‚é¡¯ç¤º
        function updateCountdown() {
            if (!breakthroughTime) return;
            
            const now = getBeijingTime();
            const timeRemaining = breakthroughTime - now;
            
            // å¦‚æœæ™‚é–“å·²éï¼Œé¡¯ç¤º0
            if (timeRemaining <= 0) {
                countdownDaysEl.textContent = "00";
                countdownHoursEl.textContent = "00";
                countdownMinutesEl.textContent = "00";
                countdownSecondsEl.textContent = "00";
                clearInterval(countdownTimer);
                return;
            }
            
            // è¨ˆç®—å¤©ã€å°æ™‚ã€åˆ†é˜ã€ç§’
            const days = Math.floor(timeRemaining / (1000 * 60 * 60 * 24));
            const hours = Math.floor((timeRemaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);
            
            // æ›´æ–°é¡¯ç¤º
            countdownDaysEl.textContent = days.toString().padStart(2, '0');
            countdownHoursEl.textContent = hours.toString().padStart(2, '0');
            countdownMinutesEl.textContent = minutes.toString().padStart(2, '0');
            countdownSecondsEl.textContent = seconds.toString().padStart(2, '0');
        }
        
        // è¨ˆç®—å‡ç´šéœ€æ±‚
        function calculateUpgradeNeeds() {
            const realm = realmSelect.value;
            const perBattle = currentSoulsPerBattle || 0;
            const tickets = parseInt(ticketsInput.value) || 0;
            
            // ç²å–ç•¶å‰å¢ƒç•Œçš„æ•¸æ“š
            const realmData = soulData[realm];
            
            // ç²å–å±¬æ€§è¨­å®š
            const attributes = [
                {
                    name: "ä¿®ç‚º",
                    current: parseInt(cultivationCurrentSelect.value) || 0,
                    target: parseInt(cultivationTargetSelect.value) || 30,
                    priority: parseInt(cultivationPrioritySelect.value) || 1,
                    costArray: realmData["ä¿®ç‚º"]
                },
                {
                    name: "å“è³ª",
                    current: parseInt(qualityCurrentSelect.value) || 0,
                    target: parseInt(qualityTargetSelect.value) || 30,
                    priority: parseInt(qualityPrioritySelect.value) || 2,
                    costArray: realmData["å“è³ª"]
                },
                {
                    name: "éˆæ¹§",
                    current: parseInt(spiritFlowCurrentSelect.value) || 0,
                    target: parseInt(spiritFlowTargetSelect.value) || 30,
                    priority: parseInt(spiritFlowPrioritySelect.value) || 3,
                    costArray: realmData["éˆæ¹§"]
                },
                {
                    name: "é«˜å“",
                    current: parseInt(highQualityCurrentSelect.value) || 0,
                    target: parseInt(highQualityTargetSelect.value) || 30,
                    priority: parseInt(highQualityPrioritySelect.value) || 4,
                    costArray: realmData["é«˜å“"]
                }
            ];
            
            // æŒ‰å„ªå…ˆé †åºæ’åº
            attributes.sort((a, b) => a.priority - b.priority);
            
            // è¨ˆç®—æ¯å€‹å±¬æ€§é‚„éœ€è¦çš„å¦–é­„ï¼ˆæŒ‰å„ªå…ˆé †åºï¼‰
            let totalNeeded = 0;
            let attributeDetails = [];
            
            attributes.forEach(attr => {
                const needed = calculateAttributeNeeds(attr.costArray, attr.current, attr.target);
                totalNeeded += needed;
                attributeDetails.push({
                    name: attr.name,
                    current: attr.current,
                    target: attr.target,
                    needed: needed,
                    priority: attr.priority
                });
            });
            
            // è¨ˆç®—é€±æ—¥çµç®—é¡å¤–å¦–é­„
            const includeSundayBonus = includeSundayBonusCheckbox.checked;
            const sundayRank = sundayRankSelect.value;
            const sundayBonusValue = sundayBonus[sundayRank] || 0;
            
            let sundayBonusTotal = 0;
            let normalBattlesNeeded = 0;
            let totalBattlesNeeded = 0;
            
            if (perBattle > 0) {
                // æ­£å¸¸æˆ°é¬¥æ‰€éœ€å ´æ¬¡
                normalBattlesNeeded = Math.ceil(totalNeeded / perBattle);
                
                // å¦‚æœè€ƒæ…®é€±æ—¥çµç®—ï¼Œè¨ˆç®—é€±æ—¥é¡å¤–å¦–é­„
                if (includeSundayBonus && sundayBonusValue > 0) {
                    // è¨ˆç®—éœ€è¦å¤šå°‘å‘¨ï¼ˆæ¯é€±3å ´ï¼‰
                    const weeksNeeded = Math.ceil(normalBattlesNeeded / 3);
                    
                    // è¨ˆç®—é€±æ—¥çµç®—ç¸½é¡å¤–å¦–é­„ï¼ˆæ¯é€±1å ´ï¼‰
                    sundayBonusTotal = weeksNeeded * sundayBonusValue;
                    
                    // ç¸½å¦–é­„éœ€æ±‚ï¼ˆåŒ…æ‹¬é€±æ—¥çµç®—ï¼‰
                    const totalSoulsWithBonus = totalNeeded + sundayBonusTotal;
                    
                    // ç¸½æˆ°é¬¥æ¬¡æ•¸ï¼ˆåŒ…æ‹¬é€±æ—¥é¡å¤–å ´æ¬¡ï¼‰
                    totalBattlesNeeded = normalBattlesNeeded;
                } else {
                    // ä¸è€ƒæ…®é€±æ—¥çµç®—
                    sundayBonusTotal = 0;
                    totalBattlesNeeded = normalBattlesNeeded;
                }
            }
            
            // è€ƒæ…®è¬å¦–ä»¤å¾Œçš„å ´æ¬¡
            const battlesAfterTickets = Math.max(0, totalBattlesNeeded - tickets);
            
            // è¨ˆç®—éœ€è¦å¤šå°‘å‘¨ï¼ˆæ¯é€±3å ´æ­£å¸¸æˆ°é¬¥ï¼‰
            const weeksNeeded = Math.ceil(normalBattlesNeeded / 3);
            
            // æ›´æ–°é¡¯ç¤º
            totalSoulsEl.textContent = formatNumber(totalNeeded + sundayBonusTotal);
            
            // é¡¯ç¤ºå¦–é­„åˆ†æ
            if (includeSundayBonus && sundayBonusValue > 0) {
                soulsBreakdownEl.style.display = "block";
                normalSoulsEl.textContent = formatNumber(totalNeeded);
                sundayBonusSoulsEl.textContent = formatNumber(sundayBonusTotal);
                totalSoulsBreakdownEl.textContent = formatNumber(totalNeeded + sundayBonusTotal);
                
                // é¡¯ç¤ºé€±æ—¥çµç®—çµæœ
                sundayBonusResultEl.style.display = "block";
                sundayBonusTotalEl.textContent = formatNumber(sundayBonusTotal) + " å¦–é­„";
            } else {
                soulsBreakdownEl.style.display = "none";
                sundayBonusResultEl.style.display = "none";
            }
            
            totalBattlesEl.textContent = `${totalBattlesNeeded} å ´`;
            battlesWithTicketsEl.textContent = `${battlesAfterTickets} å ´`;
            weeksNeededEl.textContent = `${weeksNeeded} å‘¨`;
            
            // æ›´æ–°æ˜ç´°è¡¨
            updateBreakdownTable(attributeDetails);
            
            // è¨ˆç®—æ™‚é–“è¦åŠƒ
            calculateTimePlan(totalNeeded, perBattle, tickets, totalBattlesNeeded, battlesAfterTickets, sundayBonusTotal);
        }
        
        // è¨ˆç®—å–®å€‹å±¬æ€§å‡ç´šæ‰€éœ€å¦–é­„
        function calculateAttributeNeeds(costArray, currentLevel, targetLevel) {
            if (currentLevel >= targetLevel) return 0;
            
            let total = 0;
            // å¾ç•¶å‰ç­‰ç´šå‡åˆ°ç›®æ¨™ç­‰ç´šéœ€è¦çš„å¦–é­„
            for (let i = currentLevel; i < targetLevel; i++) {
                total += costArray[i];
            }
            return total;
        }
        
        // æ›´æ–°æ˜ç´°è¡¨
        function updateBreakdownTable(attributeDetails) {
            let tableHTML = '';
            
            // æŒ‰å„ªå…ˆé †åºæ’åºé¡¯ç¤º
            attributeDetails.sort((a, b) => a.priority - b.priority);
            
            attributeDetails.forEach(attr => {
                tableHTML += `
                    <tr>
                        <td>${attr.name}</td>
                        <td>${attr.current}</td>
                        <td>${attr.target}</td>
                        <td>${formatNumber(attr.needed)}</td>
                        <td>${attr.priority}</td>
                    </tr>
                `;
            });
            
            breakdownTableEl.innerHTML = tableHTML;
        }
        
        // è¨ˆç®—æ™‚é–“è¦åŠƒ
        function calculateTimePlan(totalNeeded, perBattle, tickets, totalBattlesNeeded, battlesAfterTickets, sundayBonusTotal) {
            const days = parseInt(daysToBreakthroughInput.value) || 0;
            const hours = parseInt(hoursToBreakthroughInput.value) || 0;
            const minutes = parseInt(minutesToBreakthroughInput.value) || 0;
            const keepThreeBattles = keepThreeBattlesCheckbox.checked;
            const includeSundayBonus = includeSundayBonusCheckbox.checked;
            
            // è¨ˆç®—ç¸½åˆ†é˜æ•¸
            const totalMinutes = days * 24 * 60 + hours * 60 + minutes;
            
            if (totalMinutes === 0) {
                // æ²’æœ‰è¼¸å…¥çªç ´æ™‚é–“
                battlesBeforeBreakthroughEl.textContent = "è«‹è¼¸å…¥çªç ´æ™‚é–“";
                canCompleteBeforeBreakthroughEl.textContent = "--";
                canCompleteBeforeBreakthroughEl.className = "result-value";
                breakthroughMessageEl.innerHTML = "";
                breakthroughWeekPlanEl.textContent = "è«‹è¼¸å…¥çªç ´æ™‚é–“ä»¥é€²è¡Œè¦åŠƒ";
                weekPlanDetailsEl.textContent = "";
                strategyTipsEl.textContent = "è«‹è¼¸å…¥çªç ´æ™‚é–“ä»¥ç²å¾—æœ€ä½³ç­–ç•¥å»ºè­°";
                return;
            }
            
            // è€ƒæ…®è¬å¦–é–‹æ”¾æ™‚é–“ï¼ˆé€±ä¸‰è‡³é€±æ—¥ï¼‰
            let battlesBeforeBreakthrough = 0;
            let message = "";
            let weekPlan = "";
            let weekDetails = "";
            let strategy = "";
            
            // ç°¡å–®è¨ˆç®—ï¼šå‡è¨­æ¯é€±æœ‰5å¤©é–‹æ”¾ï¼Œä½†æ¯é€±åªèƒ½æ‰“3å ´
            const totalHours = totalMinutes / 60;
            const daysAvailable = Math.floor(totalHours / 24);
            const weeksAvailable = Math.floor(daysAvailable / 7);
            const remainingDays = daysAvailable % 7;
            
            // æ¯é€±å¯æ‰“3å ´æ­£å¸¸æˆ°é¬¥
            battlesBeforeBreakthrough = weeksAvailable * 3;
            
            // å¦‚æœè€ƒæ…®é€±æ—¥çµç®—ï¼ŒåŠ ä¸Šé€±æ—¥é¡å¤–å¦–é­„
            if (includeSundayBonus) {
                // é€±æ—¥çµç®—å¦–é­„å·²å–®ç¨è¨ˆç®—ï¼Œä¸å½±éŸ¿æˆ°é¬¥æ¬¡æ•¸
            }
            
            // å‰©é¤˜å¤©æ•¸ä¸­ï¼Œå¦‚æœæ˜¯é€±ä¸‰åˆ°é€±æ—¥ï¼Œå‰‡å¯èƒ½é‚„å¯ä»¥æ‰“
            // é€™è£¡ç°¡åŒ–è¨ˆç®—ï¼šå‡è¨­å‰©é¤˜å¤©æ•¸ä¸­æœ‰3/7çš„æ©Ÿæœƒå¯ä»¥æ‰“ï¼ˆå¯¦éš›å–æ±ºæ–¼å…·é«”æ˜ŸæœŸå¹¾ï¼‰
            const possibleBattlesInRemainingDays = Math.min(3, Math.floor(remainingDays * 3 / 5));
            battlesBeforeBreakthrough += possibleBattlesInRemainingDays;
            
            message = `è·é›¢çªç ´é‚„æœ‰ç´„ ${days} å¤© ${hours} å°æ™‚ ${minutes} åˆ†é˜ï¼Œè€ƒæ…®è¬å¦–é–‹æ”¾æ™‚é–“ï¼Œé è¨ˆå¯å®Œæˆ ${battlesBeforeBreakthrough} å ´æŒ‘æˆ°ã€‚`;
            
            // æª¢æŸ¥æ˜¯å¦å¯ä»¥åœ¨çªç ´å‰å®Œæˆ
            if (battlesAfterTickets <= battlesBeforeBreakthrough) {
                canCompleteBeforeBreakthroughEl.textContent = "å¯ä»¥";
                canCompleteBeforeBreakthroughEl.className = "result-value success";
                breakthroughMessageEl.innerHTML = `<span class="success">âœ“ æ­å–œï¼æ‚¨å¯ä»¥åœ¨çªç ´å‰å®ŒæˆåŒ–éˆè‡ºå‡ç´šã€‚</span>`;
            } else {
                canCompleteBeforeBreakthroughEl.textContent = "ç„¡æ³•";
                canCompleteBeforeBreakthroughEl.className = "result-value warning";
                const remainingBattles = battlesAfterTickets - battlesBeforeBreakthrough;
                breakthroughMessageEl.innerHTML = `<span class="warning">âœ— ç„¡æ³•åœ¨çªç ´å‰å®Œæˆå‡ç´šï¼Œé‚„å·® ${remainingBattles} å ´è¬å¦–æŒ‘æˆ°ã€‚</span>`;
            }
            
            // çªç ´ç•¶é€±è¦åŠƒ
            if (keepThreeBattles) {
                weekPlan = "å»ºè­°ç‚ºçªç ´ç•¶é€±ä¿ç•™3æ¬¡æŒ‘æˆ°æ©Ÿæœƒ";
                
                // è¨ˆç®—ä»Šå¤©æ˜ŸæœŸå¹¾
                const today = getBeijingTime();
                const dayOfWeek = today.getDay(); // 0=é€±æ—¥, 1=é€±ä¸€, ...
                
                // çªç ´æ—¥æœŸ
                const breakthroughDate = getBeijingTime();
                breakthroughDate.setDate(breakthroughDate.getDate() + days);
                breakthroughDate.setHours(breakthroughDate.getHours() + hours);
                breakthroughDate.setMinutes(breakthroughDate.getMinutes() + minutes);
                
                // åˆ¤æ–·çªç ´ç•¶é€±æ˜¯å¦é‚„æœ‰æŒ‘æˆ°æ©Ÿæœƒ
                const breakthroughDayOfWeek = breakthroughDate.getDay();
                
                // å¦‚æœçªç ´æ™‚é–“åœ¨é€±ä¸‰è‡³é€±æ—¥ä¹‹é–“ï¼Œå‰‡æœ‰æ©Ÿæœƒ
                if (breakthroughDayOfWeek >= 3 || breakthroughDayOfWeek === 0) {
                    weekDetails = "çªç ´ç•¶å¤©åœ¨è¬å¦–é–‹æ”¾æ™‚é–“å…§ï¼Œå¯ä»¥ä½¿ç”¨ä¿ç•™çš„3æ¬¡æŒ‘æˆ°æ©Ÿæœƒã€‚";
                } else {
                    weekDetails = "çªç ´ç•¶å¤©ä¸åœ¨è¬å¦–é–‹æ”¾æ™‚é–“å…§ï¼ˆé€±ä¸€æˆ–é€±äºŒï¼‰ï¼Œå»ºè­°æå‰ä½¿ç”¨æŒ‘æˆ°æ©Ÿæœƒã€‚";
                }
            } else {
                weekPlan = "ä¸ä¿ç•™æŒ‘æˆ°æ©Ÿæœƒï¼Œç›¡å¿«å®Œæˆå‡ç´š";
                weekDetails = "å»ºè­°åœ¨çªç ´å‰ç›¡å¯èƒ½å®Œæˆæ›´å¤šæŒ‘æˆ°ï¼Œä»¥ç¢ºä¿å‡ç´šå®Œæˆã€‚";
            }
            
            // ç­–ç•¥å»ºè­°
            strategy = "ç­–ç•¥å»ºè­°ï¼š";
            if (includeSundayBonus) {
                strategy += ` ç›¡é‡åœ¨é€±æ—¥å®ŒæˆæŒ‘æˆ°ä»¥ç²å¾—é¡å¤–çµç®—å¦–é­„ï¼ˆæ¯é€±1å ´ï¼‰ã€‚`;
            }
            
            if (tickets > 0) {
                strategy += ` æ‚¨è¨ˆåŠƒä½¿ç”¨ ${tickets} å€‹è¬å¦–ä»¤ï¼Œå¯ä»¥åœ¨é—œéµæ™‚åˆ»ä½¿ç”¨ä»¥åŠ é€Ÿå‡ç´šã€‚`;
            }
            
            if (days < 7) {
                strategy += " çªç ´æ™‚é–“è¼ƒè¿‘ï¼Œå»ºè­°å„ªå…ˆå‡ç´šæœ€é‡è¦çš„å±¬æ€§ï¼ˆæŒ‰è¨­å®šçš„å„ªå…ˆé †åºï¼‰ã€‚";
            }
            
            // æ ¹æ“šå¦–é­„ç²å–é‡çµ¦å»ºè­°
            if (currentSoulsPerBattle < 200) {
                strategy += " ç•¶å‰æ¯å ´ç²å–çš„å¦–é­„è¼ƒå°‘ï¼Œå»ºè­°å„ªå…ˆæŒ‘æˆ°æ›´é«˜ç´šçš„è¬å¦–é¦–é ˜ã€‚";
            }
            
            // æ›´æ–°é¡¯ç¤º
            battlesBeforeBreakthroughEl.textContent = `${battlesBeforeBreakthrough} å ´`;
            breakthroughWeekPlanEl.textContent = weekPlan;
            weekPlanDetailsEl.textContent = weekDetails;
            strategyTipsEl.textContent = strategy;
        }
        
        // æ ¼å¼åŒ–æ•¸å­—ï¼ˆæ·»åŠ åƒä½åˆ†éš”ç¬¦ï¼‰
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        // é‡ç½®è¡¨å–®
        function resetForm() {
            realmSelect.value = "çœŸä»™";
            
            // é‡ç½®å±¬æ€§ç­‰ç´š
            cultivationCurrentSelect.value = 0;
            cultivationTargetSelect.value = 30;
            cultivationPrioritySelect.value = 1;
            
            qualityCurrentSelect.value = 0;
            qualityTargetSelect.value = 30;
            qualityPrioritySelect.value = 2;
            
            spiritFlowCurrentSelect.value = 0;
            spiritFlowTargetSelect.value = 30;
            spiritFlowPrioritySelect.value = 3;
            
            highQualityCurrentSelect.value = 0;
            highQualityTargetSelect.value = 30;
            highQualityPrioritySelect.value = 4;
            
            // é‡ç½®å…¶ä»–è¼¸å…¥
            ticketsInput.value = "0";
            daysToBreakthroughInput.value = "0";
            hoursToBreakthroughInput.value = "0";
            minutesToBreakthroughInput.value = "0";
            countdownContainer.style.display = "none";
            estimatedDateContainer.style.display = "none";
            
            // é‡ç½®é€²éšé¸é …
            keepThreeBattlesCheckbox.checked = true;
            includeSundayBonusCheckbox.checked = false;
            sundayRankSelect.value = "1";
            sundayBonusOptions.style.display = "none";
            
            // æ¸…é™¤å€’æ•¸è¨ˆæ™‚å™¨
            if (countdownTimer) {
                clearInterval(countdownTimer);
                countdownTimer = null;
            }
            
            // é‡æ–°åˆå§‹åŒ–è¬å¦–é¸æ“‡
            initMonsterSelect();
            
            // é‡ç½®çµæœ
            totalSoulsEl.textContent = "0";
            soulsBreakdownEl.style.display = "none";
            sundayBonusResultEl.style.display = "none";
            totalBattlesEl.textContent = "0 å ´";
            battlesWithTicketsEl.textContent = "0 å ´";
            weeksNeededEl.textContent = "0 å‘¨";
            breakdownTableEl.innerHTML = "";
            
            battlesBeforeBreakthroughEl.textContent = "0 å ´";
            canCompleteBeforeBreakthroughEl.textContent = "--";
            canCompleteBeforeBreakthroughEl.className = "result-value";
            breakthroughMessageEl.innerHTML = "";
            breakthroughWeekPlanEl.textContent = "--";
            weekPlanDetailsEl.textContent = "";
            strategyTipsEl.textContent = "--";
        }
        
        // äº‹ä»¶ç›£è½å™¨
        calculateBtn.addEventListener('click', calculateUpgradeNeeds);
        resetBtn.addEventListener('click', resetForm);
        
        // ç•¶çªç ´æ™‚é–“è®ŠåŒ–æ™‚ï¼Œæ›´æ–°å€’æ•¸è¨ˆæ™‚å’Œé è¨ˆæ—¥æœŸ
        daysToBreakthroughInput.addEventListener('input', startCountdown);
        hoursToBreakthroughInput.addEventListener('input', startCountdown);
        minutesToBreakthroughInput.addEventListener('input', startCountdown);
        
        // ç•¶å¢ƒç•Œè®ŠåŒ–æ™‚ï¼Œæ›´æ–°è¬å¦–é¸æ“‡
        realmSelect.addEventListener('change', function() {
            initMonsterSelect();
            calculateUpgradeNeeds();
        });
        
        // ç•¶è¬å¦–é¸æ“‡è®ŠåŒ–æ™‚
        monsterSelect.addEventListener('change', function() {
            updateMonsterSelect();
            calculateUpgradeNeeds();
        });
        
        // ç•¶é€±æ—¥çµç®—é¸é …è®ŠåŒ–æ™‚ï¼Œé¡¯ç¤º/éš±è—æ’åé¸æ“‡
        includeSundayBonusCheckbox.addEventListener('change', function() {
            if (this.checked) {
                sundayBonusOptions.style.display = "block";
            } else {
                sundayBonusOptions.style.display = "none";
            }
            calculateUpgradeNeeds();
        });
        
        // ç•¶å±¬æ€§ç­‰ç´šæˆ–å„ªå…ˆé †åºè®ŠåŒ–æ™‚ï¼Œé‡æ–°è¨ˆç®—
        const attributeInputs = [
            cultivationCurrentSelect, cultivationTargetSelect, cultivationPrioritySelect,
            qualityCurrentSelect, qualityTargetSelect, qualityPrioritySelect,
            spiritFlowCurrentSelect, spiritFlowTargetSelect, spiritFlowPrioritySelect,
            highQualityCurrentSelect, highQualityTargetSelect, highQualityPrioritySelect,
            sundayRankSelect
        ];
        
        attributeInputs.forEach(input => {
            input.addEventListener('change', calculateUpgradeNeeds);
        });
        
        // ç•¶è¬å¦–ä»¤æ•¸é‡è®ŠåŒ–æ™‚ï¼Œé‡æ–°è¨ˆç®—
        ticketsInput.addEventListener('input', calculateUpgradeNeeds);
        
        // ç•¶é€²éšé¸é …è®ŠåŒ–æ™‚ï¼Œé‡æ–°è¨ˆç®—
        keepThreeBattlesCheckbox.addEventListener('change', calculateUpgradeNeeds);
        includeSundayBonusCheckbox.addEventListener('change', calculateUpgradeNeeds);
        
        // åˆå§‹è¨­å®š
        initLevelSelects();
        initMonsterSelect();
        initSaveSystem(); // åˆå§‹åŒ–å­˜æª”ç³»çµ±
        startCountdown();
        calculateUpgradeNeeds();
        
        // æ›´æ–°åŒ—äº¬æ™‚é–“é¡¯ç¤º
        updateBeijingTime();
        setInterval(updateBeijingTime, 1000);
        
        // å°‡å­˜æª”ç›¸é—œå‡½æ•¸è¨­ç‚ºå…¨å±€å¯è¨ªå•
        window.renameSaveSlot = renameSaveSlot;
        window.loadSaveSlot = loadSaveSlot;
        window.saveToSlot = saveToSlot;
        window.deleteSaveSlot = deleteSaveSlot;
    </script>
</body>
</html>
